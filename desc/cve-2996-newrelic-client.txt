Report by: Al1ex@knownsec
Received: 2020-12-22
Contact author: hps_fly@163.com or https://github.com/Al1ex/
Evaluation:

  - Library itself not notable, see
  
  https://mvnrepository.com/artifact/com.newrelic.agent.java/newrelic-agent

  with only 6 deps. But one of its dependencies:
  
  https://mvnrepository.com/artifact/com.taoensso/timbre  

  is a Clojure library depended on by 752 artifacts so it does qualify, depending
  on version 3.31.1 which does have classes described.
  
---------------------------------------------------------------------------

Vulnerability description

com.newrelic.agent.deps.ch.qos.logback.core.db.JNDIConnectionSource 
com.newrelic.agent.deps.ch.qos.logback.core.db.DriverManagerConnectionSource

Class bypasses the
blacklist class previously maintained by Jackson databind, and rce can be caused if the JDK
version is lower.

Vulnerability proof

Pom.xml:

<dependencies>
	<!-- https://mvnrepository.com/artifact/com.newrelic.agent.java/newrelic-agent -->
	<dependency>
		<groupId>com.newrelic.agent.java</groupId>
		<artifactId>newrelic-agent</artifactId>
		<version>3.31.1</version>
	</dependency>
	<dependency>
		<groupId>org.slf4j</groupId>
		<artifactId>slf4j-nop</artifactId>
		<version>1.7.2</version>
	</dependency>
	<!-- https://mvnrepository.com/artifact/javax.transaction/jta -->
	<dependency>
		<groupId>javax.transaction</groupId>
		<artifactId>jta</artifactId>
		<version>1.1</version>
	</dependency>
</dependencies>


