Report by: Artem Godin (via security@vaadin.com)
Received: 2021-09-03

Description:

The following classes can be used to form a deserialization gadget chain:

com.vaadin:vaadin-server versions 7.0.0 prior to 8.0.0: com.vaadin.data.util.NestedMethodProperty
com.vaadin:vaadin-server versions 7.0.0 prior to 8.0.0: com.vaadin.data.util.PropertysetItem
com.vaadin:vaadin-compatibility-server all versions: com.vaadin.v7.data.util.NestedMethodProperty
com.vaadin:vaadin-compatibility-server all versions: com.vaadin.v7.data.util.PropertysetItem

See

https://vaadin.com/security/2018-11-13

Notability:

Due to timing, most gadget reports are no longer processed: however, Vaadin
is widely enough used so that evaluation was made.

---------------------------------------------------------------------------

Evaluation: (2021-10-30)

I was not able to figure out a way how this gadget could be exploited using
Jackson, because:

1. None of constructors would be applicable by default (no 0-arg constructor
   nor 1-arg constructor with one of "natural" types; String, int/Integer, long/Long)
2. Mechanism used elsewhere seems to rely on JDK serialization: Jackson does not
   make of it at all

This is not to say there could not be possible exploitation in some form,
but with documentation provided so far there is insufficient support for this.

Although earlier (when Jackson 2.9 was supported) we might have added blocks
just to err on side of caution, at this point we do not add speculative blocks.

---------------------------------------------------------------------------
pom.xml

Dependencies:

* com.vaadin:vaadin-server:7.7.14
* com.vaadin:vaadin-shared:7.7.14

And possible gadget types:

"com.vaadin:vaadin-server" (versions 7.0.0 prior to 8.0.0):

com.vaadin.data.util.NestedMethodProperty
com.vaadin.data.util.PropertysetItem

"com.vaadin:vaadin-compatibility-server" (all versions):

com.vaadin.v7.data.util.NestedMethodProperty
com.vaadin.v7.data.util.PropertysetItem


---------------------------------------------------------------------------
POC: - none devised yet -
