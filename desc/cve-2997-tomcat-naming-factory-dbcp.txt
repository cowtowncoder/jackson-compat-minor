Report by: Al1ex@knownsec
Received: 2020-12-22
Contact author: hps_fly@163.com or https://github.com/Al1ex/
Evaluation:

  Library itself:
  
  https://mvnrepository.com/artifact/tomcat/naming-factory-dbcp

  is not quite notable enough (8 deps) but the most widely used of
  these dependencies:

  https://mvnrepository.com/artifact/org.wso2.carbon/org.wso2.carbon.server

  would qualify (with 20 deps) so this qualifies.

---------------------------------------------------------------------------

Vulnerability description

org.apache.tomcat.dbcp.dbcp.datasources.PerUserPoolDataSource
org.apache.tomcat.dbcp.dbcp.datasources.SharedPoolDataSource

Class bypasses the
blacklist class previously maintained by Jackson databind, and rce can be caused if the JDK
version is lower.

Vulnerability proof

Pom.xml:

<dependencies>
  <dependency>
	<groupId>tomcat</groupId>
	<artifactId>naming-factory-dbcp</artifactId>
	<version>5.5.23</version>
  </dependency>
</dependencies>


